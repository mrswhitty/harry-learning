<!doctype html>
<html lang="en" class="h-full">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Harry's Memory Game</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="/_sdk/element_sdk.js"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;500;600;700&amp;display=swap" rel="stylesheet">
  <style>
    body {
      box-sizing: border-box;
    }
    
    * {
      font-family: 'Fredoka', sans-serif;
    }
    
    .card-container {
      perspective: 1000px;
    }
    
    .card-inner {
      transition: transform 0.5s;
      transform-style: preserve-3d;
    }
    
    .card-flipped .card-inner {
      transform: rotateY(180deg);
    }
    
    .card-front, .card-back {
      backface-visibility: hidden;
      -webkit-backface-visibility: hidden;
    }
    
    .card-back {
      transform: rotateY(180deg);
    }
    
    .card-matched {
      animation: celebrate 0.6s ease-out;
    }
    
    @keyframes celebrate {
      0%, 100% { transform: scale(1) rotateY(180deg); }
      50% { transform: scale(1.1) rotateY(180deg); }
    }
    
    @keyframes bounce {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-10px); }
    }
    
    .bounce {
      animation: bounce 0.5s ease-in-out infinite;
    }
    
    @keyframes confetti-fall {
      0% { transform: translateY(-100%) rotate(0deg); opacity: 1; }
      100% { transform: translateY(100vh) rotate(720deg); opacity: 0; }
    }
    
    .confetti {
      position: fixed;
      width: 10px;
      height: 10px;
      animation: confetti-fall 3s ease-out forwards;
    }
    
    @keyframes wiggle {
      0%, 100% { transform: rotate(-3deg); }
      50% { transform: rotate(3deg); }
    }
    
    .wiggle {
      animation: wiggle 0.3s ease-in-out;
    }
    
    .question-bubble {
      animation: float 3s ease-in-out infinite;
    }
    
    @keyframes float {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-5px); }
    }
  </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
 </head>
 <body class="h-full">
  <div id="app" class="h-full w-full overflow-auto" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);"><!-- Main Game Container -->
   <div class="min-h-full p-4 md:p-6"><!-- Header -->
    <div class="text-center mb-4">
     <h1 id="gameTitle" class="text-3xl md:text-4xl font-bold text-white drop-shadow-lg mb-2">ğŸš— Harry's Memory Game ğŸšš</h1>
     <div class="flex justify-center items-center gap-4 flex-wrap">
      <div class="bg-white/20 backdrop-blur-sm rounded-full px-4 py-2 text-white font-semibold">
       â­ Matches: <span id="matchCount">0</span>/9
      </div>
      <div class="bg-white/20 backdrop-blur-sm rounded-full px-4 py-2 text-white font-semibold">
       ğŸ¯ Tries: <span id="tryCount">0</span>
      </div><button id="resetBtn" onclick="resetGame()" class="bg-yellow-400 hover:bg-yellow-300 text-purple-800 font-bold px-4 py-2 rounded-full shadow-lg transform hover:scale-105 transition-all"> ğŸ”„ New Game </button>
     </div>
    </div><!-- Game Board -->
    <div id="gameBoard" class="max-w-4xl mx-auto grid grid-cols-3 sm:grid-cols-6 gap-2 md:gap-3 mb-6"><!-- Cards will be inserted here -->
    </div><!-- Question Section -->
    <div class="max-w-2xl mx-auto">
     <div class="question-bubble bg-white/90 backdrop-blur-sm rounded-3xl p-4 md:p-6 shadow-xl">
      <div class="flex items-center gap-3 mb-3"><span class="text-3xl">ğŸ’¬</span>
       <h2 class="text-xl md:text-2xl font-bold text-purple-700">Let's Chat About Vehicles!</h2>
      </div>
      <p id="questionText" class="text-lg md:text-xl text-gray-700 mb-4">What is your favourite type of vehicle?</p><button onclick="nextQuestion()" class="bg-gradient-to-r from-pink-500 to-purple-500 hover:from-pink-400 hover:to-purple-400 text-white font-bold px-6 py-2 rounded-full shadow-lg transform hover:scale-105 transition-all"> ğŸ² Next Question </button>
     </div>
    </div><!-- Winner Modal -->
    <div id="winnerModal" class="hidden fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4">
     <div class="bg-white rounded-3xl p-6 md:p-8 max-w-md w-full text-center shadow-2xl transform scale-100">
      <div class="text-6xl mb-4">
       ğŸ†
      </div>
      <h2 id="winnerMessage" class="text-2xl md:text-3xl font-bold text-purple-700 mb-2">Amazing Job, Harry!</h2>
      <p class="text-gray-600 mb-4">You found all the matching vehicles!</p>
      <div class="text-4xl mb-4">
       ğŸš— ğŸšš ğŸï¸ ğŸšŒ ğŸšœ
      </div>
      <p class="text-lg text-purple-600 font-semibold mb-4">You did it in <span id="finalTries">0</span> tries!</p><button onclick="closeWinnerModal()" class="bg-gradient-to-r from-yellow-400 to-orange-400 hover:from-yellow-300 hover:to-orange-300 text-purple-800 font-bold px-8 py-3 rounded-full shadow-lg transform hover:scale-105 transition-all text-xl"> ğŸ® Play Again! </button>
     </div>
    </div>
   </div>
  </div>
  <script>
    // Vehicle data with SVG icons
    const vehicles = [
      { id: 'truck', name: 'Truck', emoji: 'ğŸšš', color: '#ef4444' },
      { id: 'car', name: 'Car', emoji: 'ğŸš—', color: '#3b82f6' },
      { id: 'motorbike', name: 'Motorbike', emoji: 'ğŸï¸', color: '#f59e0b' },
      { id: 'mixer', name: 'Cement Mixer', emoji: 'ğŸ”„', color: '#10b981', svg: `<svg viewBox="0 0 100 100" class="w-full h-full"><circle cx="50" cy="45" r="25" fill="#f97316"/><rect x="20" y="60" width="60" height="15" rx="3" fill="#64748b"/><circle cx="30" cy="80" r="8" fill="#1e293b"/><circle cx="70" cy="80" r="8" fill="#1e293b"/><path d="M35 45 L65 45 L60 30 L40 30 Z" fill="#fbbf24"/></svg>` },
      { id: 'bus', name: 'Bus', emoji: 'ğŸšŒ', color: '#8b5cf6' },
      { id: 'tractor', name: 'Tractor', emoji: 'ğŸšœ', color: '#22c55e' },
      { id: 'firetruck', name: 'Fire Truck', emoji: 'ğŸš’', color: '#dc2626' },
      { id: 'ambulance', name: 'Ambulance', emoji: 'ğŸš‘', color: '#f8fafc' },
      { id: 'racecar', name: 'Race Car', emoji: 'ğŸï¸', color: '#06b6d4' }
    ];

    const questions = [
      "What is your favourite type of vehicle?",
      "If you could drive any vehicle, which one would you pick?",
      "What colour would you paint your dream car?",
      "Have you ever been on a bus? Where did you go?",
      "What sounds does a fire truck make?",
      "What's a car you might like to have when you grow up?",
      "Would you rather ride a motorbike or drive a truck?",
      "If you were a race car driver, what would your racing name be?",
      "What vehicle would be best for going on a camping trip?",
      "Can you make the sound of a tractor? Vroom vroom!"
    ];

    let cards = [];
    let flippedCards = [];
    let matchedPairs = 0;
    let tries = 0;
    let canFlip = true;
    let currentQuestionIndex = 0;

    const defaultConfig = {
      game_title: "ğŸš— Harry's Memory Game ğŸšš",
      winner_message: "Amazing Job, Harry!",
      primary_color: "#667eea",
      secondary_color: "#f093fb",
      text_color: "#ffffff",
      card_color: "#7c3aed",
      accent_color: "#fbbf24"
    };

    let config = { ...defaultConfig };

    function createCardHTML(vehicle, index) {
      const vehicleDisplay = vehicle.svg 
        ? vehicle.svg 
        : `<span class="text-5xl md:text-6xl">${vehicle.emoji}</span>`;
      
      return `
        <div class="card-container aspect-square cursor-pointer" data-index="${index}" onclick="flipCard(${index})">
          <div class="card-inner relative w-full h-full">
            <!-- Card Back (hidden state) -->
            <div class="card-front absolute inset-0 rounded-2xl shadow-lg flex items-center justify-center"
                 style="background: linear-gradient(135deg, ${config.card_color} 0%, #a855f7 100%);">
              <div class="text-4xl md:text-5xl text-white/80">â“</div>
              <div class="absolute inset-2 border-4 border-white/20 rounded-xl"></div>
            </div>
            <!-- Card Front (revealed state) -->
            <div class="card-back absolute inset-0 bg-white rounded-2xl shadow-lg flex flex-col items-center justify-center p-2">
              <div class="flex-1 flex items-center justify-center w-full">
                ${vehicleDisplay}
              </div>
              <p class="text-xs md:text-sm font-bold text-gray-700 truncate w-full text-center">${vehicle.name}</p>
            </div>
          </div>
        </div>
      `;
    }

    function initializeGame() {
      // Create pairs and shuffle
      const gameVehicles = [...vehicles, ...vehicles];
      cards = gameVehicles
        .map((vehicle, index) => ({ ...vehicle, originalIndex: index }))
        .sort(() => Math.random() - 0.5)
        .map((vehicle, index) => ({ ...vehicle, index, flipped: false, matched: false }));
      
      const gameBoard = document.getElementById('gameBoard');
      gameBoard.innerHTML = cards.map((card, index) => createCardHTML(card, index)).join('');
      
      matchedPairs = 0;
      tries = 0;
      flippedCards = [];
      canFlip = true;
      
      updateUI();
    }

    function flipCard(index) {
      if (!canFlip) return;
      
      const card = cards[index];
      if (card.flipped || card.matched) return;
      if (flippedCards.length >= 2) return;
      
      // Flip the card
      card.flipped = true;
      flippedCards.push(index);
      
      const cardElement = document.querySelector(`[data-index="${index}"]`);
      cardElement.classList.add('card-flipped');
      cardElement.classList.add('wiggle');
      setTimeout(() => cardElement.classList.remove('wiggle'), 300);
      
      // Check for match if two cards are flipped
      if (flippedCards.length === 2) {
        canFlip = false;
        tries++;
        updateUI();
        
        const [first, second] = flippedCards;
        const card1 = cards[first];
        const card2 = cards[second];
        
        if (card1.id === card2.id) {
          // Match found!
          setTimeout(() => {
            card1.matched = true;
            card2.matched = true;
            matchedPairs++;
            
            const el1 = document.querySelector(`[data-index="${first}"] .card-inner`);
            const el2 = document.querySelector(`[data-index="${second}"] .card-inner`);
            el1.classList.add('card-matched');
            el2.classList.add('card-matched');
            
            flippedCards = [];
            canFlip = true;
            updateUI();
            
            if (matchedPairs === 9) {
              setTimeout(showWinner, 500);
            }
          }, 500);
        } else {
          // No match - flip back
          setTimeout(() => {
            card1.flipped = false;
            card2.flipped = false;
            
            document.querySelector(`[data-index="${first}"]`).classList.remove('card-flipped');
            document.querySelector(`[data-index="${second}"]`).classList.remove('card-flipped');
            
            flippedCards = [];
            canFlip = true;
          }, 1000);
        }
      }
    }

    function updateUI() {
      document.getElementById('matchCount').textContent = matchedPairs;
      document.getElementById('tryCount').textContent = tries;
    }

    function nextQuestion() {
      currentQuestionIndex = (currentQuestionIndex + 1) % questions.length;
      const questionEl = document.getElementById('questionText');
      questionEl.style.opacity = '0';
      setTimeout(() => {
        questionEl.textContent = questions[currentQuestionIndex];
        questionEl.style.opacity = '1';
      }, 200);
    }

    function showWinner() {
      document.getElementById('finalTries').textContent = tries;
      document.getElementById('winnerModal').classList.remove('hidden');
      createConfetti();
    }

    function closeWinnerModal() {
      document.getElementById('winnerModal').classList.add('hidden');
      resetGame();
    }

    function resetGame() {
      initializeGame();
    }

    function createConfetti() {
      const colors = ['#ef4444', '#f59e0b', '#22c55e', '#3b82f6', '#8b5cf6', '#ec4899'];
      const container = document.getElementById('app');
      
      for (let i = 0; i < 50; i++) {
        const confetti = document.createElement('div');
        confetti.className = 'confetti';
        confetti.style.left = Math.random() * 100 + '%';
        confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
        confetti.style.animationDelay = Math.random() * 2 + 's';
        confetti.style.borderRadius = Math.random() > 0.5 ? '50%' : '0';
        container.appendChild(confetti);
        
        setTimeout(() => confetti.remove(), 5000);
      }
    }

    function applyConfig() {
      document.getElementById('gameTitle').textContent = config.game_title;
      document.getElementById('winnerMessage').textContent = config.winner_message;
    }

    // Element SDK Integration
    if (window.elementSdk) {
      window.elementSdk.init({
        defaultConfig,
        onConfigChange: async (newConfig) => {
          config = { ...defaultConfig, ...newConfig };
          applyConfig();
        },
        mapToCapabilities: (cfg) => ({
          recolorables: [
            {
              get: () => cfg.primary_color || defaultConfig.primary_color,
              set: (value) => {
                cfg.primary_color = value;
                window.elementSdk.setConfig({ primary_color: value });
              }
            },
            {
              get: () => cfg.card_color || defaultConfig.card_color,
              set: (value) => {
                cfg.card_color = value;
                window.elementSdk.setConfig({ card_color: value });
              }
            },
            {
              get: () => cfg.accent_color || defaultConfig.accent_color,
              set: (value) => {
                cfg.accent_color = value;
                window.elementSdk.setConfig({ accent_color: value });
              }
            }
          ],
          borderables: [],
          fontEditable: {
            get: () => cfg.font_family || 'Fredoka',
            set: (value) => {
              cfg.font_family = value;
              window.elementSdk.setConfig({ font_family: value });
            }
          },
          fontSizeable: undefined
        }),
        mapToEditPanelValues: (cfg) => new Map([
          ["game_title", cfg.game_title || defaultConfig.game_title],
          ["winner_message", cfg.winner_message || defaultConfig.winner_message]
        ])
      });
    }

    // Initialize game on load
    initializeGame();
    document.getElementById('questionText').style.transition = 'opacity 0.2s ease';
  </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9c9fa433c224a95b',t:'MTc3MDQzMzI3My4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
